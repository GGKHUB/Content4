# Pre-built Dockerfile - Angular app already built locally
FROM node:18-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install only production dependencies
RUN npm install --omit=dev

# Copy server files
COPY server/ ./server/

# Copy pre-built Angular app
COPY client/dist/ ./client/dist/

# Create uploads directory
RUN mkdir -p ./server/uploads

EXPOSE 5000

ENV NODE_ENV=production
ENV PORT=5000

CMD ["node", "server/index.js"]
